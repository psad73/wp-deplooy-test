!function(){var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var i;t.g.importScripts&&(i=t.g.location+"");var e=t.g.document;if(!i&&e&&(e.currentScript&&(i=e.currentScript.src),!i)){var o=e.getElementsByTagName("script");o.length&&(i=o[o.length-1].src)}if(!i)throw new Error("Automatic publicPath is not supported in this browser");i=i.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=i+"../"}();var i={};t.p=window.zionBuilderPaths[{}.appName],function(){"use strict";t.r(i);const e=window.jQuery,o=window.wp;new class{constructor(t){this.isEditorEnabled=t.is_editor_enabled,this.postId=t.post_id,this.l10n=t.l10n,this.isProcessingAction=!1,this.cacheDom(),this.attachEvents(),this.$document.on("heartbeat-error",this.onHearBeatError.bind(this)),this.$document.on("heartbeat-tick.autosave",this.onHearBeatReceived.bind(this))}cacheDom(){this.$document=e(document),this.$window=e(window),this.$body=e("body"),this.$postTitle=e("#title"),this.$editorActivateButton=e(".znpb-admin-post__edit-button--activate"),this.$editorDeactivateButton=e(".znpb-admin-post__edit-button--deactivate"),this.$buttonsWrapper=e(".znpb-admin-post__edit-buttons-wrapper")}attachEvents(){this.$editorActivateButton.on("click",this.onEditButtonPress.bind(this)),this.$editorDeactivateButton.on("click",this.onDisableButtonPress.bind(this))}getTranslatedString(t){if(void 0!==this.l10n[t])return this.l10n[t]}onHearBeatError(){this.isProcessingAction=!1,this.$editorActivateButton.removeClass("znpb-admin-post__edit-button--loading"),this.$editorDeactivateButton.removeClass("znpb-admin-post__edit-button--loading")}onHearBeatReceived(t,i){void 0!==i.zion_builder_status&&(this.setEditorStatus(i.zion_builder_status),this.isEditorEnabled&&(this.$window.off("beforeunload.edit-post"),window.history.replaceState({id:this.postId},"Post "+this.postId,this.getPostEditURL()),location.href=this.$editorActivateButton.attr("href"))),this.isProcessingAction=!1,this.$editorActivateButton.removeClass("znpb-admin-post__edit-button--loading"),this.$editorDeactivateButton.removeClass("znpb-admin-post__edit-button--loading")}getPostEditURL(){return`post.php?post=${this.postId}&action=edit`}setEditorStatus(t){this.isEditorEnabled=t,this.updateUi(t)}updateUi(t){t?this.$body.addClass("znpb-admin-post-editor--active"):this.$body.removeClass("znpb-admin-post-editor--active")}onEditButtonPress(t){this.isEditorEnabled||(t.preventDefault(),this.$postTitle.val()||this.$postTitle.val(`ZionBuilder #${this.postId}`).trigger("input"),o.autosave?(this.$window.off("beforeunload.edit-post"),this.$editorActivateButton.addClass("znpb-admin-post__edit-button--loading"),this.saveEditorStatus(!0)):alert(this.getTranslatedString("wp_heartbeat_disabled")))}saveEditorStatus(t){if(this.isProcessingAction)return;const i=this.postId;this.isProcessingAction=!0,e(document).on("heartbeat-send.autosave",(function(e,o){o.zion_builder_status=t,o.zion_builder_post_id=i})),o.autosave.server.triggerSave()}onDisableButtonPress(t){t.preventDefault(),this.isEditorEnabled&&(this.$editorDeactivateButton.addClass("znpb-admin-post__edit-button--loading"),this.saveEditorStatus(!1))}}(window.ZnPbEditPostData.data)}(),(window.zb=window.zb||{})["edit-page"]=i}();